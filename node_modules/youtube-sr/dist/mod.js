var V=Object.defineProperty,K=Object.defineProperties,W=Object.getOwnPropertyDescriptor,Q=Object.getOwnPropertyDescriptors,G=Object.getOwnPropertyNames,N=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var J=(u,e,t)=>e in u?V(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t,w=(u,e)=>{for(var t in e||(e={}))M.call(e,t)&&J(u,t,e[t]);if(N)for(var t of N(e))Z.call(e,t)&&J(u,t,e[t]);return u},f=(u,e)=>K(u,Q(e)),X=u=>V(u,"__esModule",{value:!0});var ee=(u,e)=>{for(var t in e)V(u,t,{get:e[t],enumerable:!0})},te=(u,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of G(e))!M.call(u,r)&&(t||r!=="default")&&V(u,r,{get:()=>e[r],enumerable:!(i=W(e,r))||i.enumerable});return u};var ne=(u=>(e,t)=>u&&u.get(e)||(t=te(X({}),e,1),u&&u.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var g=(u,e,t)=>new Promise((i,r)=>{var n=a=>{try{l(t.next(a))}catch(o){r(o)}},s=a=>{try{l(t.throw(a))}catch(o){r(o)}},l=a=>a.done?i(a.value):Promise.resolve(a.value).then(n,s);l((t=t.apply(u,e)).next())});var ce={};ee(ce,{Channel:()=>v,Playlist:()=>P,Thumbnail:()=>_,Util:()=>d,Video:()=>b,YouTube:()=>y,default:()=>de});var H=class{constructor(e){if(!e)throw new Error(`Cannot instantiate the ${this.constructor.name} class without data!`);this._patch(e)}_patch(e){e||(e={}),this.name=e.name||null,this.verified=!!e.verified||!1,this.id=e.id||null,this.url=e.url||null,this.icon=e.icon||{url:null,width:0,height:0},this.subscribers=e.subscribers||null}iconURL(e={size:0}){if(typeof e.size!="number"||e.size<0)throw new Error("invalid icon size");if(!this.icon.url)return null;let t=this.icon.url.split("=s")[1].split("-c")[0];return this.icon.url.replace(`=s${t}-c`,`=s${e.size}-c`)}get type(){return"channel"}toString(){return this.name||""}toJSON(){return{name:this.name,verified:this.verified,id:this.id,url:this.url,iconURL:this.iconURL(),type:this.type,subscribers:this.subscribers}}},v=H;var ie="https://www.youtube.com/youtubei/v1/browse?key=",j=class{constructor(e={},t=!1){this._continuation={};if(!e)throw new Error(`Cannot instantiate the ${this.constructor.name} class without data!`);t?this._patchSearch(e):this._patch(e)}_patch(e){var t,i,r,n,s,l;this.id=e.id||null,this.title=e.title||null,this.videoCount=e.videoCount||0,this.lastUpdate=e.lastUpdate||null,this.views=e.views||0,this.url=e.url||null,this.link=e.link||null,this.channel=e.author||null,this.thumbnail=e.thumbnail||null,this.videos=e.videos||[],this._continuation.api=(i=(t=e.continuation)==null?void 0:t.api)!=null?i:null,this._continuation.token=(n=(r=e.continuation)==null?void 0:r.token)!=null?n:null,this._continuation.clientVersion=(l=(s=e.continuation)==null?void 0:s.clientVersion)!=null?l:"<important data>"}_patchSearch(e){this.id=e.id||null,this.title=e.title||null,this.thumbnail=e.thumbnail||null,this.channel=e.channel||null,this.videos=[],this.videoCount=e.videos||0,this.url=this.id?`https://www.youtube.com/playlist?list=${this.id}`:null,this.link=null,this.lastUpdate=null,this.views=0}next(e=1/0){return g(this,null,function*(){var n,s,l;if(!this._continuation||!this._continuation.token)return[];let t=yield d.getHTML(`${ie}${this._continuation.api}`,{method:"POST",body:JSON.stringify({continuation:this._continuation.token,context:{client:{utcOffsetMinutes:0,gl:"US",hl:"en",clientName:"WEB",clientVersion:this._continuation.clientVersion},user:{},request:{}}})}),i=(l=(s=(n=d.json(t))==null?void 0:n.onResponseReceivedActions[0])==null?void 0:s.appendContinuationItemsAction)==null?void 0:l.continuationItems;if(!i)return[];let r=d.getPlaylistVideos(i,e);return this._continuation.token=d.getContinuationToken(i),this.videos=[...this.videos,...r],r})}fetch(e=1/0){return g(this,null,function*(){if(!this._continuation.token)return this;for(e<1&&(e=1/0);typeof this._continuation.token=="string"&&this._continuation.token.length&&!(this.videos.length>=e||!(yield this.next()).length););return this})}get type(){return"playlist"}*[Symbol.iterator](){yield*this.videos}toJSON(){return{id:this.id,title:this.title,thumbnail:this.thumbnail.toJSON(),channel:{name:this.channel.name,id:this.channel.id,icon:this.channel.iconURL()},url:this.url,videos:this.videos}}},P=j;var z=class{constructor(e){if(!e)throw new Error(`Cannot instantiate the ${this.constructor.name} class without data!`);this._patch(e)}_patch(e){e||(e={}),this.id=e.id||null,this.width=e.width||0,this.height=e.height||0,this.url=e.url||null}displayThumbnailURL(e="ultrares"){if(!["default","hqdefault","mqdefault","sddefault","maxresdefault","ultrares"].includes(e))throw new Error(`Invalid thumbnail type "${e}"!`);return e==="ultrares"?this.url:`https://i3.ytimg.com/vi/${this.id}/${e}.jpg`}defaultThumbnailURL(e){if(e||(e="0"),!["0","1","2","3","4"].includes(e))throw new Error(`Invalid thumbnail id "${e}"!`);return`https://i3.ytimg.com/vi/${this.id}/${e}.jpg`}toString(){return this.url?`${this.url}`:""}toJSON(){return{id:this.id,width:this.width,height:this.height,url:this.url}}},_=z;var F=class{constructor(e){if(!e)throw new Error(`Cannot instantiate the ${this.constructor.name} class without data!`);this._patch(e)}_patch(e){var t,i;e||(e={}),this.id=e.id||null,this.title=e.title||null,this.description=e.description||null,this.durationFormatted=e.duration_raw||"0:00",this.duration=(e.duration<0?0:e.duration)||0,this.uploadedAt=e.uploadedAt||null,this.views=parseInt(e.views)||0,this.thumbnail=new _(e.thumbnail||{}),this.channel=new v(e.channel||{}),this.likes=((t=e.ratings)==null?void 0:t.likes)||0,this.dislikes=((i=e.ratings)==null?void 0:i.dislikes)||0,this.live=!!e.live,this.private=!!e.private,this.tags=e.tags||[],this.videos=e.videos||[]}get url(){return this.id?`https://www.youtube.com/watch?v=${this.id}`:null}embedHTML(e={id:"ytplayer",width:640,height:360}){return this.id?`<iframe title="__youtube_sr_frame__" id="${e.id||"ytplayer"}" type="text/html" width="${e.width||640}" height="${e.height||360}" src="${this.embedURL}" frameborder="0"></iframe>`:null}get embedURL(){return this.id?`https://www.youtube.com/embed/${this.id}`:null}get type(){return"video"}toString(){return this.url||""}toJSON(){return{id:this.id,url:this.url,title:this.title,description:this.description,duration:this.duration,duration_formatted:this.durationFormatted,uploadedAt:this.uploadedAt,thumbnail:this.thumbnail.toJSON(),channel:{name:this.channel.name,id:this.channel.id,icon:this.channel.iconURL()},views:this.views,type:this.type,tags:this.tags,ratings:{likes:this.likes,dislikes:this.dislikes},live:this.live,private:this.private}}},b=F;var re=/^https?:\/\/(www.)?youtube.com\/playlist\?list=((PL|UU|LL|RD|OL)[a-zA-Z0-9-_]{16,41})$/,k=/(PL|UU|LL|RD|OL)[a-zA-Z0-9-_]{16,41}/,se=/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/,le=/^[a-zA-Z0-9-_]{11}$/,oe=ue(),ae="AIzaSyAO_FJ2SlqU8Q4STEHLGCilw_Y9_11qcW8";function ue(){if(typeof window!="undefined")return window.fetch;if(typeof globalThis.fetch=="function")return globalThis.fetch;for(let u of["undici","node-fetch"])try{let e=require(u),t=e.fetch||e.default||e;if(t)return t}catch(e){}throw new Error("Could not find fetch library. Install `node-fetch`/`undici` or define `fetch` in global scope!")}var m=class{constructor(){throw new Error(`The ${this.constructor.name} class may not be instantiated!`)}static get VideoRegex(){return se}static get VideoIDRegex(){return le}static get PlaylistURLRegex(){return re}static get PlaylistIDRegex(){return k}static getHTML(e,t){return t||(t={headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0"}}),new Promise((i,r)=>{oe(e,t).then(n=>{if(!n.ok)throw new Error(`Rejected with status code: ${n.status}`);return n.text()}).then(n=>i(n)).catch(n=>r(n))})}static parseDuration(e){e!=null||(e="0:00");let t=e.split(":"),i=0;switch(t.length){case 3:i=parseInt(t[0])*60*60*1e3+parseInt(t[1])*60*1e3+parseInt(t[2])*1e3;break;case 2:i=parseInt(t[0])*60*1e3+parseInt(t[1])*1e3;break;default:i=parseInt(t[0])*1e3}return i}static parseSearchResult(e,t){if(!e)throw new Error("Invalid raw data");t||(t={type:"video",limit:0}),t.type||(t.type="video");let i=[],r=[],n=!1;try{e=e.split("ytInitialData = JSON.parse('")[1].split("');<\/script>")[0].replace(/\\x([0-9A-F]{2})/gi,(...l)=>String.fromCharCode(parseInt(l[1],16)))}catch(s){}try{r=JSON.parse(e.split('{"itemSectionRenderer":{"contents":')[e.split('{"itemSectionRenderer":{"contents":').length-1].split(',"continuations":[{')[0]),n=!0}catch(s){}if(!n)try{r=JSON.parse(e.split('{"itemSectionRenderer":')[e.split('{"itemSectionRenderer":').length-1].split('},{"continuationItemRenderer":{')[0]).contents,n=!0}catch(s){}if(!n)return[];for(let s=0;s<r.length&&!(typeof t.limit=="number"&&t.limit>0&&i.length>=t.limit);s++){let l=r[s],a;if(t.type==="all")if(l.videoRenderer)t.type="video";else if(l.channelRenderer)t.type="channel";else if(l.playlistRenderer)t.type="playlist";else continue;if(t.type==="video"){let o=m.parseVideo(l);if(!o)continue;a=o}else if(t.type==="channel"){let o=m.parseChannel(l);if(!o)continue;a=o}else if(t.type==="playlist"){let o=m.parsePlaylist(l);if(!o)continue;a=o}i.push(a)}return i}static parseChannel(e){var n,s;if(!e||!e.channelRenderer)return;let t=e.channelRenderer.ownerBadges&&e.channelRenderer.ownerBadges[0],i=`https://www.youtube.com${e.channelRenderer.navigationEndpoint.browseEndpoint.canonicalBaseUrl||e.channelRenderer.navigationEndpoint.commandMetadata.webCommandMetadata.url}`;return new v({id:e.channelRenderer.channelId,name:e.channelRenderer.title.simpleText,icon:e.channelRenderer.thumbnail.thumbnails[e.channelRenderer.thumbnail.thumbnails.length-1],url:i,verified:Boolean((s=(n=t==null?void 0:t.metadataBadgeRenderer)==null?void 0:n.style)==null?void 0:s.toLowerCase().includes("verified")),subscribers:e.channelRenderer.subscriberCountText.simpleText})}static parseVideo(e){var r,n,s,l,a,o,h;if(!e||!e.videoRenderer)return;let t=e.videoRenderer.ownerBadges&&e.videoRenderer.ownerBadges[0];return new b({id:e.videoRenderer.videoId,url:`https://www.youtube.com/watch?v=${e.videoRenderer.videoId}`,title:e.videoRenderer.title.runs[0].text,description:e.videoRenderer.descriptionSnippet&&e.videoRenderer.descriptionSnippet.runs[0]?e.videoRenderer.descriptionSnippet.runs[0].text:"",duration:e.videoRenderer.lengthText?m.parseDuration(e.videoRenderer.lengthText.simpleText):0,duration_raw:e.videoRenderer.lengthText?e.videoRenderer.lengthText.simpleText:null,thumbnail:{id:e.videoRenderer.videoId,url:e.videoRenderer.thumbnail.thumbnails[e.videoRenderer.thumbnail.thumbnails.length-1].url,height:e.videoRenderer.thumbnail.thumbnails[e.videoRenderer.thumbnail.thumbnails.length-1].height,width:e.videoRenderer.thumbnail.thumbnails[e.videoRenderer.thumbnail.thumbnails.length-1].width},channel:{id:e.videoRenderer.ownerText.runs[0].navigationEndpoint.browseEndpoint.browseId||null,name:e.videoRenderer.ownerText.runs[0].text||null,url:`https://www.youtube.com${e.videoRenderer.ownerText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl||e.videoRenderer.ownerText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url}`,icon:{url:e.videoRenderer.channelThumbnailSupportedRenderers.channelThumbnailWithLinkRenderer.thumbnail.thumbnails[0].url,width:e.videoRenderer.channelThumbnailSupportedRenderers.channelThumbnailWithLinkRenderer.thumbnail.thumbnails[0].width,height:e.videoRenderer.channelThumbnailSupportedRenderers.channelThumbnailWithLinkRenderer.thumbnail.thumbnails[0].height},verified:Boolean((n=(r=t==null?void 0:t.metadataBadgeRenderer)==null?void 0:r.style)==null?void 0:n.toLowerCase().includes("verified"))},uploadedAt:(l=(s=e.videoRenderer.publishedTimeText)==null?void 0:s.simpleText)!=null?l:null,views:(h=(o=(a=e.videoRenderer.viewCountText)==null?void 0:a.simpleText)==null?void 0:o.replace(/[^0-9]/g,""))!=null?h:0})}static parsePlaylist(e){return e.playlistRenderer?new P({id:e.playlistRenderer.playlistId,title:e.playlistRenderer.title.simpleText,thumbnail:{id:e.playlistRenderer.playlistId,url:e.playlistRenderer.thumbnails[0].thumbnails[e.playlistRenderer.thumbnails[0].thumbnails.length-1].url,height:e.playlistRenderer.thumbnails[0].thumbnails[e.playlistRenderer.thumbnails[0].thumbnails.length-1].height,width:e.playlistRenderer.thumbnails[0].thumbnails[e.playlistRenderer.thumbnails[0].thumbnails.length-1].width},channel:{id:e.playlistRenderer.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.browseId,name:e.playlistRenderer.shortBylineText.runs[0].text,url:`https://www.youtube.com${e.playlistRenderer.shortBylineText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url}`},videos:parseInt(e.playlistRenderer.videoCount.replace(/[^0-9]/g,""))},!0):void 0}static getPlaylistVideos(e,t=1/0){var r,n,s,l;let i=[];for(let a=0;a<e.length&&t!==i.length;a++){let o=e[a].playlistVideoRenderer;!o||!o.shortBylineText||i.push(new b({id:o.videoId,index:parseInt((r=o.index)==null?void 0:r.simpleText)||0,duration:m.parseDuration((n=o.lengthText)==null?void 0:n.simpleText)||0,duration_raw:(l=(s=o.lengthText)==null?void 0:s.simpleText)!=null?l:"0:00",thumbnail:{id:o.videoId,url:o.thumbnail.thumbnails[o.thumbnail.thumbnails.length-1].url,height:o.thumbnail.thumbnails[o.thumbnail.thumbnails.length-1].height,width:o.thumbnail.thumbnails[o.thumbnail.thumbnails.length-1].width},title:o.title.runs[0].text,channel:{id:o.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.browseId||null,name:o.shortBylineText.runs[0].text||null,url:`https://www.youtube.com${o.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl||o.shortBylineText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url}`,icon:null}}))}return i}static getPlaylist(e,t){var R,I,x,T,E,c,C,$,D,A,B,U,q;(!t||typeof t!="number")&&(t=100),t<=0&&(t=1/0);let i,r;try{let S=`${e.split('{"playlistVideoListRenderer":{"contents":')[1].split('}],"playlistId"')[0]}}]`;i=JSON.parse(S),r=JSON.parse(e.split('{"playlistSidebarRenderer":')[1].split("}};<\/script>")[0]).items}catch(S){return null}let n=(T=(x=(R=e.split('INNERTUBE_API_KEY":"')[1])==null?void 0:R.split('"')[0])!=null?x:(I=e.split('innertubeApiKey":"')[1])==null?void 0:I.split('"')[0])!=null?T:ae,s=m.getPlaylistVideos(i,t),l=r[0].playlistSidebarPrimaryInfoRenderer;if(!l.title.runs||!l.title.runs.length)return null;let a=(E=r[1])==null?void 0:E.playlistSidebarSecondaryInfoRenderer.videoOwner,o=l.stats.length===3?l.stats[1].simpleText.replace(/[^0-9]/g,""):0,h=($=(C=(c=l.stats.find(S=>"runs"in S&&S.runs.find(Y=>Y.text.toLowerCase().includes("last update"))))==null?void 0:c.runs.pop())==null?void 0:C.text)!=null?$:null,p=l.stats[0].runs[0].text.replace(/[^0-9]/g,"")||0;return new P({continuation:{api:n,token:m.getContinuationToken(i),clientVersion:(U=(B=(D=e.split('"INNERTUBE_CONTEXT_CLIENT_VERSION":"')[1])==null?void 0:D.split('"')[0])!=null?B:(A=e.split('"innertube_context_client_version":"')[1])==null?void 0:A.split('"')[0])!=null?U:"<some version>"},id:l.title.runs[0].navigationEndpoint.watchEndpoint.playlistId,title:l.title.runs[0].text,videoCount:parseInt(p)||0,lastUpdate:h,views:parseInt(o)||0,videos:s,url:`https://www.youtube.com/playlist?list=${l.title.runs[0].navigationEndpoint.watchEndpoint.playlistId}`,link:`https://www.youtube.com${l.title.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url}`,author:a?{name:a.videoOwnerRenderer.title.runs[0].text,id:a.videoOwnerRenderer.title.runs[0].navigationEndpoint.browseEndpoint.browseId,url:`https://www.youtube.com${a.videoOwnerRenderer.navigationEndpoint.commandMetadata.webCommandMetadata.url||a.videoOwnerRenderer.navigationEndpoint.browseEndpoint.canonicalBaseUrl}`,icon:a.videoOwnerRenderer.thumbnail.thumbnails.length?a.videoOwnerRenderer.thumbnail.thumbnails[a.videoOwnerRenderer.thumbnail.thumbnails.length-1].url:null}:{},thumbnail:((q=l.thumbnailRenderer.playlistVideoThumbnailRenderer)==null?void 0:q.thumbnail.thumbnails.length)?l.thumbnailRenderer.playlistVideoThumbnailRenderer.thumbnail.thumbnails[l.thumbnailRenderer.playlistVideoThumbnailRenderer.thumbnail.thumbnails.length-1].url:null})}static getContinuationToken(e){var i,r,n;return(n=(r=(i=e.find(s=>Object.keys(s)[0]==="continuationItemRenderer"))==null?void 0:i.continuationItemRenderer.continuationEndpoint)==null?void 0:r.continuationCommand)==null?void 0:n.token}static getVideo(e){var l,a,o,h;let t,i={};try{let p=JSON.parse(e.split("var ytInitialData = ")[1].split(";<\/script>")[0]);t=p.contents.twoColumnWatchNextResults.results.results.contents;try{i=p.contents.twoColumnWatchNextResults.secondaryResults.secondaryResults.results}catch(O){}}catch(p){throw new Error("Could not parse video metadata!")}let r={primary:(l=t.find(p=>"videoPrimaryInfoRenderer"in p))==null?void 0:l.videoPrimaryInfoRenderer,secondary:(a=t.find(p=>"videoSecondaryInfoRenderer"in p))==null?void 0:a.videoSecondaryInfoRenderer},n;try{n=JSON.parse(e.split("var ytInitialPlayerResponse = ")[1].split(";<\/script>")[0]).videoDetails}catch(p){n=JSON.parse(e.split("var ytInitialPlayerResponse = ")[1].split(";var meta")[0]).videoDetails}return n=f(w(w({},r.primary),r.secondary),{info:n}),new b({id:n.info.videoId,title:n.info.title,views:parseInt(n.info.viewCount)||0,tags:n.info.keywords,private:n.info.isPrivate,live:n.info.isLiveContent,duration:parseInt(n.info.lengthSeconds)*1e3,duration_raw:m.durationString(m.parseMS(parseInt(n.info.lengthSeconds)*1e3||0)),channel:{name:n.info.author,id:n.info.channelId,url:`https://www.youtube.com${n.owner.videoOwnerRenderer.title.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl}`,icon:n.owner.videoOwnerRenderer.thumbnail.thumbnails[0],subscribers:(h=(o=n.owner.videoOwnerRenderer.subscriberCountText)==null?void 0:o.simpleText)==null?void 0:h.replace(" subscribers","")},description:n.info.shortDescription,thumbnail:f(w({},n.info.thumbnail.thumbnails[n.info.thumbnail.thumbnails.length-1]),{id:n.info.videoId}),uploadedAt:n.dateText.simpleText,ratings:{likes:this.getInfoLikesCount(n)||0,dislikes:0},videos:m.getNext(i!=null?i:{})||[]})}static getInfoLikesCount(e){var r;let i=e.videoActions.menuRenderer.topLevelButtons.find(n=>{var s;return((s=n.toggleButtonRenderer)==null?void 0:s.defaultIcon.iconType)==="LIKE"});return i?parseInt((r=i.toggleButtonRenderer.defaultText.accessibility)==null?void 0:r.accessibilityData.label.split(" ")[0].replace(/,/g,"")):0}static getNext(e,t=!1){var r,n,s,l,a;let i=[];if(typeof e[Symbol.iterator]!="function")return i;for(let o of e){let h=t?o:o.compactVideoRenderer;if(h)try{let p=h.viewCountText.simpleText;p=(/^\d/.test(p)?p:"0").split(" ")[0],i.push(new b({id:h.videoId,title:(n=h.title.simpleText)!=null?n:(r=h.title.runs[0])==null?void 0:r.text,views:parseInt(p.replace(/,/g,""))||0,duration_raw:(s=h.lengthText.simpleText)!=null?s:h.lengthText.accessibility.accessibilityData.label,duration:m.parseDuration(h.lengthText.simpleText)/1e3,channel:{name:h.shortBylineText.runs[0].text,id:h.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.browseId,url:`https://www.youtube.com${h.shortBylineText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl}`,icon:t?h.channelThumbnailSupportedRenderers.channelThumbnailWithLinkRenderer.thumbnail.thumbnails[0]:h.channelThumbnail.thumbnails[0],subscribers:"0",verified:Boolean(h.ownerBadges[0].metadataBadgeRenderer.tooltip==="Verified")},thumbnail:f(w({},h.thumbnail.thumbnails[h.thumbnail.thumbnails.length-1]),{id:h.videoId}),uploadedAt:h.publishedTimeText.simpleText,ratings:{likes:0,dislikes:0},description:(a=(l=h.descriptionSnippet)==null?void 0:l.runs[0])==null?void 0:a.text}))}catch(p){continue}}return i}static parseHomepage(e){let t;try{t=e.split("var ytInitialData = ")[1].split(";<\/script>")[0],t=JSON.parse(t).contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.richGridRenderer.contents}catch(i){return[]}return!t||!t.length||!t.find(i=>Object.keys(i)[0]==="richItemRenderer")?[]:(t=t.filter(i=>Object.keys(i)[0]==="richItemRenderer").map(i=>i.richItemRenderer.content.videoRenderer),m.getNext(t,!0))}static getPlaylistURL(e){if(typeof e!="string")return null;let t=k.exec(e);return t?`https://www.youtube.com/playlist?list=${t[0]}`:null}static validatePlaylist(e){if(!(typeof e=="string"&&e.match(k)!==null))throw new Error("Invalid playlist url")}static filter(e){switch(e){case"playlist":return"EgIQAw%253D%253D";case"video":return"EgIQAQ%253D%253D";case"channel":return"EgIQAg%253D%253D";default:throw new TypeError(`Invalid filter type "${e}"!`)}}static parseMS(e){let t=e>0?Math.floor:Math.ceil;return{days:t(e/864e5),hours:t(e/36e5)%24,minutes:t(e/6e4)%60,seconds:t(e/1e3)%60}}static durationString(e){let t=Object.keys(e),i=["days","hours","minutes","seconds"],r=t.filter(s=>i.includes(s)).map(s=>e[s]>0?e[s]:""),n=r.slice(r.findIndex(s=>!!s)).map((s,l)=>l==0?s.toString():s.toString().padStart(2,"0")).join(":");return n.length<=3?`0:${n.padStart(2,"0")||0}`:n}static json(e){try{return JSON.parse(e)}catch(t){return null}}},d=m;var he="PREF=f2=8000000",y=class{constructor(){throw new Error(`The ${this.constructor.name} class may not be instantiated!`)}static search(e,t){return g(this,null,function*(){if(t||(t={limit:20,type:"video",requestOptions:{}}),!e||typeof e!="string")throw new Error(`Invalid search query "${e}"!`);t.type=t.type||"video";let i=t.type==="all"?"":`&sp=${d.filter(t.type)}`,r=`https://youtube.com/results?q=${encodeURIComponent(e.trim()).replace(/%20/g,"+")}&hl=en${i}`,n=t.safeSearch?f(w({},t.requestOptions),{headers:{cookie:he}}):{},s=yield d.getHTML(r,n);return d.parseSearchResult(s,t)})}static searchOne(e,t,i,r){return t||(t="video"),new Promise(n=>{y.search(e,{limit:1,type:t,requestOptions:r,safeSearch:Boolean(i)}).then(s=>{if(!s||!s.length)return n(null);n(s[0])}).catch(()=>{n(null)})})}static getPlaylist(e,t){return g(this,null,function*(){if(t||(t={limit:100,requestOptions:{}}),!e||typeof e!="string")throw new Error(`Expected playlist url, received ${typeof e}!`);d.validatePlaylist(e),e=d.getPlaylistURL(e);let i=yield d.getHTML(`${e}&hl=en`,t&&t.requestOptions);return d.getPlaylist(i,t&&t.limit)})}static getVideo(e,t){return g(this,null,function*(){if(!e)throw new Error("Missing video url");if(e instanceof b&&(e=e.url),!y.validate(e,"VIDEO"))throw new Error("Invalid video url");let r=yield d.getHTML(`${e}&hl=en`,t);return d.getVideo(r)})}static homepage(){return g(this,null,function*(){let e=yield d.getHTML("https://www.youtube.com?hl=en");return d.parseHomepage(e)})}static fetchInnerTubeKey(){return g(this,null,function*(){var i,r,n;let e=yield d.getHTML("https://www.youtube.com?hl=en"),t=(n=(i=e.split('INNERTUBE_API_KEY":"')[1])==null?void 0:i.split('"')[0])!=null?n:(r=e.split('innertubeApiKey":"')[1])==null?void 0:r.split('"')[0];return t!=null?t:null})}static trending(){return g(this,null,function*(){var n,s,l,a,o,h,p,O,R,I,x,T,E;let e=yield d.getHTML("https://www.youtube.com/feed/explore?hl=en"),t;try{t=JSON.parse(e.split("var ytInitialData =")[1].split(";")[0])}catch(c){return null}let i=(x=(I=(R=(O=(p=(h=(o=(a=(l=(s=(n=t.contents)==null?void 0:n.twoColumnBrowseResultsRenderer)==null?void 0:s.tabs[0].tabRenderer)==null?void 0:l.content)==null?void 0:a.sectionListRenderer)==null?void 0:o.contents[1])==null?void 0:h.itemSectionRenderer)==null?void 0:p.contents[0])==null?void 0:O.shelfRenderer)==null?void 0:R.content)==null?void 0:I.expandedShelfContentsRenderer)==null?void 0:x.items;if(!i||!Array.isArray(i))return null;let r=[];for(let c of i.map(C=>C.videoRenderer))r.push(new b({title:c.title.runs[0].text,id:c.videoId,url:`https://www.youtube.com/watch?v=${c.videoId}`,description:(E=(T=c.descriptionSnippet)==null?void 0:T.runs[0])==null?void 0:E.text,duration:d.parseDuration(c.lengthText.simpleText)/1e3||0,duration_raw:c.lengthText.simpleText,thumbnail:{id:c.videoId,url:c.thumbnail.thumbnails[c.thumbnail.thumbnails.length-1].url,height:c.thumbnail.thumbnails[c.thumbnail.thumbnails.length-1].height,width:c.thumbnail.thumbnails[c.thumbnail.thumbnails.length-1].width},channel:{id:c.ownerText.runs[0].navigationEndpoint.browseEndpoint.browseId,name:c.ownerText.runs[0].text,url:`https://www.youtube.com${c.ownerText.runs[0].navigationEndpoint.browseEndpoint.canonicalBaseUrl}`,icon:{url:null,width:0,height:0},verified:c.ownerBadges?Boolean(c.ownerBadges[0].metadataBadgeRenderer.tooltip==="Verified"):!1},uploadedAt:c.publishedTimeText.simpleText,views:c.viewCountText.simpleText.replace(/[^0-9]/g,"")||0}));return r})}static getSuggestions(e){return g(this,null,function*(){if(!e)throw new Error("Search query was not provided!");let t=yield d.getHTML(`https://clients1.google.com/complete/search?client=youtube&gs_ri=youtube&ds=yt&q=${encodeURIComponent(e)}`),i=[];return t.split("[").forEach((r,n)=>{if(!(!r.split('"')[1]||n===1))return i.push(r.split('"')[1])}),i.pop(),i})}static validate(e,t){if(typeof e!="string")return!1;switch(t||(t="PLAYLIST"),t){case"PLAYLIST":return y.Regex.PLAYLIST_URL.test(e);case"PLAYLIST_ID":return y.Regex.PLAYLIST_ID.test(e);case"VIDEO":return y.Regex.VIDEO_URL.test(e);case"VIDEO_ID":return y.Regex.VIDEO_ID.test(e);default:return!1}}static isPlaylist(e){try{return d.validatePlaylist(e),!0}catch(t){return!1}}static get Regex(){return{PLAYLIST_URL:d.PlaylistURLRegex,PLAYLIST_ID:d.PlaylistIDRegex,VIDEO_ID:d.VideoIDRegex,VIDEO_URL:d.VideoRegex}}};var de=y;module.exports=ne(ce);0&&(module.exports={Channel,Playlist,Thumbnail,Util,Video,YouTube});
